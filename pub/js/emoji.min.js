(function(window,document){function myUrl(){var i=-1,baseurl="",scripts=document.documentElement.getElementsByTagName("script");while(++i<scripts.length){baseurl=scripts[i].getAttribute("src");if(baseurl&&/js\/emoji(\.min)?\.js/.test(baseurl)){return baseurl}}return baseurl}var confClass="emojified",confTheme="android",confScript=myUrl(),confQuery=confScript.split("?")[1];if(/theme=(\w+)/.exec(confQuery)){confTheme=RegExp.$1}if("android"===confTheme&&-1!==navigator.userAgent.indexOf("; Android")){return}function log(text){window.console&&console.log&&console.log(text)}function compileSurrogate(hi,lo){return(hi-55296)*1024+(lo-56320)+65536}function findEmoji(text){if(!text){return[]}var found=[],reg=/[\u203C-\uFFFF][\uDC00-\uDFFF]?/g,matches,match,lo,hi,index;while(matches=reg.exec(text)){match=matches[0];index=reg.lastIndex;hi=match.charCodeAt(0);lo=match.charCodeAt(1);if(isNaN(lo)){found.push([--index,1,hi,match])}else if(hi<55296||hi>56319){found.push([--index,1,lo,match]);found.push([--index,1,hi,match])}else{found.push([index-=2,2,compileSurrogate(hi,lo),match])}}return found}function convert(window){var document=window.document,body=document.body,head=document.head||document.getElementsByTagName("head")[0];if(!body||!head){return}function createElement(className,innerText,tagName){var span=document.createElement(tagName||"span");span.className=className||"";innerText&&span.appendChild(createText(innerText));return span}function createText(innerText){return document.createTextNode(innerText)}function emojifyTextNode(textNode){var text=textNode.nodeValue,found=findEmoji(text);if(!found.length){return}var wrapNode=createElement(confClass),i=-1,next=0,index,code,length;while(++i<found.length){match=found[i][3];index=found[i][0];length=found[i][1];code=found[i][2];if(index>next){wrapNode.appendChild(createText(text.substring(next,index)))}wrapNode.appendChild(createElement("emoji emoji-"+code.toString(16),match));emojifyCount++;next=index+length}if(text.length>next){wrapNode.appendChild(createText(text.substr(next)))}textNode.parentNode.replaceChild(wrapNode,textNode)}function emojifyAttribute(element,attr,text){text=text||element.getAttribute(attr);var found=findEmoji(text);if(!found.length){return}var classes=element.className?element.className.split(/\s+/):[];classes.push(confClass);element.className=classes.join(" ");emojifyCount+=found.length}function descend(parent){if(-1!==parent.className.indexOf(confClass)){return}var length=parent.childNodes.length;if(!length){parent.hasAttribute("value")&&emojifyAttribute(parent,"value",parent.value);return}switch(parent.tagName){case"STYLE":case"SCRIPT":return}var i=-1,child;while(++i<length){child=parent.childNodes[i];switch(child.nodeType){case 1:descend(child);break;case 3:emojifyTextNode(child);break}}}var emojifyCount=0;descend(body);if(emojifyCount&&window.OSEmojiLoaded!==confTheme){var id="osemojicss",link=document.getElementById(id);link&&head.removeChild(link);link=createElement("","","link");link.setAttribute("href",confScript.replace(/\/js\/emoji(\.min)?\.js/,"/css/emoji-"+confTheme+".css"));link.setAttribute("rel","stylesheet");link.setAttribute("id",id);head.appendChild(link);window.OSEmojiLoaded=confTheme}}window.OSEmoji={run:convert};convert(window)})(window,document);